!function($){"use strict";function isFullscreen(){return $(".tx-editor-overlay").length>0}function relocate(el){var yPos=($(window).height()-el.height())/2,xPos=($(window).width()-el.width())/2;el.css({top:yPos,left:xPos})}function transitions($el,$editor){relocate($editor),isFullscreen()?$el.focus():($el.focus(),$editor.css("opacity",1))}function FullscreenTextarea(el,opts){var method,i;for(this.$el=$(el),this.settings={overlay:!0,maxWidth:"",maxHeight:"",key:null},i=0;i<this.bindMethods.length;i++)method=this.bindMethods[i],this[method]=$.proxy(this,method);this.init(opts)}FullscreenTextarea.prototype.$el=null,FullscreenTextarea.prototype.$widget=null,FullscreenTextarea.prototype.$editor=null,FullscreenTextarea.prototype.$icon=null,FullscreenTextarea.prototype.init=function(opts){var content;if(this.settings=$.extend(!0,this.settings,opts),!this.$el.is("textarea"))return void $.error("Error initializing Textarea Fullscreen Editor Plugin. It can only work on <textarea> element.");content='<div class="tx-editor-wrapper"><div class="tx-editor"><a href="#" class="tx-icon"></a></div></div>',this.$wrapper=$(content).insertAfter(this.$el),this.$editor=this.$wrapper.find(".tx-editor"),this.$icon=this.$editor.find(".tx-icon"),this.$editor.append(this.$el),this.$el.css({width:"100%",height:"100%",resize:"none"});var self=this;null!==this.settings.key&&this.$wrapper.on("keyup",function(e){!e.ctrlKey||String.fromCharCode(e.which)!=self.settings.key.toUpperCase()&&String.fromCharCode(e.which)!=self.settings.key||(isFullscreen()?self.minimize():self.expand())}),this.$icon.on("click.txeditor.icon",this.onIconClick)},FullscreenTextarea.prototype.bindMethods=["onOverlayClick","onIconClick","onKeyUp","onResize"],FullscreenTextarea.prototype.showOverlay=function(){return $('<div class="tx-editor-overlay" />').appendTo("body").fadeTo(0,1).click(this.onOverlayClick),this},FullscreenTextarea.prototype.removeOverlay=function(){var $overlay=$(".tx-editor-overlay");return $overlay.length&&$overlay.fadeTo(0,0,function(){$(this).remove()}),this},FullscreenTextarea.prototype.expand=function(){var settings=this.settings,$editor=this.$editor;return settings.maxWidth&&$editor.css("max-width",settings.maxWidth),settings.maxHeight&&$editor.css("max-height",settings.maxHeight),settings.overlay&&this.showOverlay(),$editor.addClass("expanded"),transitions(this.$el,this.$editor),$(window).on("resize.txeditor",this.onResize),$(window).on("keyup.txeditor",this.onKeyUp),this},FullscreenTextarea.prototype.minimize=function(){var settings=this.settings,$editor=this.$editor;return $(window).off("resize.txeditor",this.onResize),$(window).off("keyup.txeditor",this.onKeyUp),$editor.removeClass("expanded").css({"max-width":"none","max-height":"none"}),transitions(this.$el,$editor),settings.overlay&&this.removeOverlay(),this},FullscreenTextarea.prototype.destroy=function(){var $wrapper=this.$wrapper;return this.removeOverlay(),this.$el=this.$el.detach(),this.$el.insertBefore($wrapper),$wrapper.remove(),this.$wrapper=null,this.$icon=null,this.$editor=null,$(window).off("keyup.txeditor",this.onKeyUp).off("resize.txeditor",this.onResize),this},FullscreenTextarea.prototype.onOverlayClick=function(){this.minimize()},FullscreenTextarea.prototype.onIconClick=function(e){e.preventDefault(),isFullscreen()?this.minimize():this.expand()},FullscreenTextarea.prototype.onKeyUp=function(e){27===e.keyCode&&isFullscreen()&&this.minimize()},FullscreenTextarea.prototype.onResize=function(e){relocate(this.$editor)},$.fn.textareafullscreen=function(options){return this.each(function(){var fullscreenTextarea,args,$this=$(this);if("string"==typeof options){if(fullscreenTextarea=$this.data("textareafullscreendata"),"function"==typeof fullscreenTextarea[options])return args=Array.prototype.slice.call(arguments,1),fullscreenTextarea[options].apply(fullscreenTextarea,args);$.error("Method "+options+" does not exist on jQuery.textareafullscreen")}else $this.data("textareafullscreendata",new FullscreenTextarea(this,options))})}}(jQuery);