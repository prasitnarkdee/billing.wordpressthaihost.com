INSERT INTO `hb_reports` (`id`, `type`, `name`, `query`, `options`, `handler`, `state`, `columns`)
VALUES
	(NULL, 'Invoices', 'Aging Invoices', 'SELECT cd.id as `Client ID`,\r\n cd.companyname as `Organization`,\r\n CONCAT(cd.firstname,\' \',cd.lastname) as `Primary Contact`,\r\n ca.email as `Email`,\r\n cd.phonenumber as `Phone`,\r\n COALESCE(SUM(CASE WHEN i.duedate < CURDATE() \r\nAND i.duedate >= DATE_SUB(CURDATE(),INTERVAL 30 DAY) THEN i.total END),0) as `Aged Over 1-30`,\r\n COALESCE(SUM(CASE WHEN i.duedate < DATE_SUB(CURDATE(),INTERVAL 30 DAY) \r\nAND i.duedate >= DATE_SUB(CURDATE(),INTERVAL 60 DAY) THEN i.total END),0) as `Aged Over 31-60`,\r\n COALESCE(SUM(CASE WHEN i.duedate < DATE_SUB(CURDATE(),INTERVAL 60 DAY) \r\nAND i.duedate >= DATE_SUB(CURDATE(),INTERVAL 90 DAY) THEN i.total END),0) as `Aged Over 61-90`,\r\n COALESCE(SUM(CASE WHEN i.duedate < DATE_SUB(CURDATE(),INTERVAL 90 DAY) THEN i.total END),0) as `Aged Over 90`,\r\n SUM(i.total) as `Total Due` \r\nFROM hb_client_details cd \r\nINNER JOIN hb_client_access ca ON (ca.id = cd.id) \r\nINNER JOIN hb_invoices i ON i.client_id = ca.id \r\nWHERE\r\n i.status = \'Unpaid\' \r\nAND i.duedate < CURDATE() \r\nAND i.total > 0 \r\nGROUP BY i.client_id \r\n\r\nORDER BY `Total Due` DESC', 1, 'sql', 'a:3:{s:6:\"params\";N;s:10:\"conditions\";a:0:{}s:6:\"output\";s:4:\"html\";}', 'a:10:{i:0;s:9:\"Client ID\";i:1;s:12:\"Organization\";i:2;s:15:\"Primary Contact\";i:3;s:5:\"Email\";i:4;s:5:\"Phone\";i:5;s:14:\"Aged Over 1-30\";i:6;s:15:\"Aged Over 31-60\";i:7;s:15:\"Aged Over 61-90\";i:8;s:12:\"Aged Over 90\";i:9;s:9:\"Total Due\";}');
